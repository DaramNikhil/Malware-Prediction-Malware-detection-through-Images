import os
import shutil
from sklearn.model_selection import train_test_split

def split_data(source_dir, dest_dir, split_ratios=(0.7, 0.2, 0.1)):
    categories = ['malware', 'benign']
    for category in categories:
        category_path = os.path.join(source_dir, category)
        files = os.listdir(category_path)
        train_files, temp_files = train_test_split(files, test_size=(1 - split_ratios[0]), random_state=42)
        val_files, test_files = train_test_split(temp_files, test_size=(split_ratios[2] / (split_ratios[1] + split_ratios[2])), random_state=42)

        for dataset, dataset_files in zip(['train', 'val', 'test'], [train_files, val_files, test_files]):
            target_dir = os.path.join(dest_dir, dataset, category)
            os.makedirs(target_dir, exist_ok=True)
            for file in dataset_files:
                shutil.copy(os.path.join(category_path, file), target_dir)

source_directory = 'data'
destination_directory = 'dataset'
split_data(source_directory, destination_directory)
